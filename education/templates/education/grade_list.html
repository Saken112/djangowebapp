{% extends "base.html" %}
{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">üìã –°–ø–∏—Å–æ–∫ –æ—Ü–µ–Ω–æ–∫</h2>

    <form method="get" class="row g-3 mb-4 align-items-end justify-content-center">
        <!-- –°—Ç—É–¥–µ–Ω—Ç -->
        <div class="col-md-2">
            <label class="form-label">üë§ –°—Ç—É–¥–µ–Ω—Ç</label>
            <input type="text" name="student_name" class="form-control" placeholder="–ò–º—è..." value="{{ request.GET.student_name }}">
        </div>

        <!-- –ö—É—Ä—Å -->
        <div class="col-md-2">
            <label class="form-label">üìö –ö—É—Ä—Å</label>
            <select name="course" class="form-select">
                <option value="">–í—Å–µ –∫—É—Ä—Å—ã</option>
                {% for c in all_courses %}
                    <option value="{{ c.id }}" {% if request.GET.course == c.id|stringformat:"s" %}selected{% endif %}>{{ c.name }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- –¢–∏–ø –æ—Ü–µ–Ω–∫–∏ -->
        <div class="col-md-2">
            <label class="form-label">üìë –¢–∏–ø</label>
            <select name="grade_type" class="form-select">
                <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                {% for key, label in grade_types %}
                    <option value="{{ key }}" {% if request.GET.grade_type == key %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- –° -->
        <div class="col-md-2">
            <label class="form-label">üìÖ –°</label>
            <input type="date" name="date_from" class="form-control" value="{{ request.GET.date_from }}">
        </div>

        <!-- –ü–æ -->
        <div class="col-md-2">
            <label class="form-label">üìÖ –ü–æ</label>
            <input type="date" name="date_to" class="form-control" value="{{ request.GET.date_to }}">
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ -->
        <div class="col-md-2 d-grid gap-2">
            <button type="submit" class="btn btn-outline-primary">üîç –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å</button>
            <a href="{% url 'grade_list' %}" class="btn btn-outline-secondary">–°–±—Ä–æ—Å–∏—Ç—å</a>
        </div>
    </form>

    {% if grades %}
    <div class="card shadow-sm rounded-4 p-4">
        <div class="table-responsive">
            <table class="table table-hover align-middle text-center">
                <thead class="table-light">
                    <tr>
                        <th>üë§ –°—Ç—É–¥–µ–Ω—Ç</th>
                        <th>üìö –ö—É—Ä—Å</th>
                        <th>üìë –¢–∏–ø</th>
                        <th>‚úÖ –û—Ü–µ–Ω–∫–∞</th>
                        <th>üìÖ –î–∞—Ç–∞</th>
                    </tr>
                </thead>
                <tbody>
                    {% for grade in grades %}
                    <tr>
                        <td>{{ grade.student }}</td>
                        <td>{{ grade.course }}</td>
                        <td>{{ grade.get_grade_type_display }}</td>
                        <td><span class="badge bg-light border text-dark">{{ grade.grade }}</span></td>
                        <td>{{ grade.date_received|date:"d.m.Y" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% else %}
    <div class="alert alert-info text-center mt-4">
        –û—Ü–µ–Ω–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–∞–º.
    </div>
    {% endif %}

    {% if user.is_teacher %}
    <div class="text-center mt-4">
        <a href="{% url 'add_grade' %}" class="btn btn-outline-primary rounded-pill px-4 py-2">
            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}
